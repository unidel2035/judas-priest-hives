
docs.polza.ai
POST Chat Completions | –ó–∞–ø—Ä–æ—Å –∫ –º–æ–¥–µ–ª–∏
31‚Äì44 minutes

POST https://api.polza.ai/api/v1/chat/completions

–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —è–∑—ã–∫–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ —á–µ—Ä–µ–∑ –Ω–∞—à API-–∞–≥—Ä–µ–≥–∞—Ç–æ—Ä. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∏–∞–ª–æ–≥–∏, –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Ç–µ–∫—Å—Ç + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è), –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–æ—Ç–æ–∫–æ–≤—É—é –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

    ü§ñ –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ª—É—á—à–µ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏

    üí∞ –ë–∏–ª–ª–∏–Ω–≥ –≤ —Ä—É–±–ª—è—Ö - —Ç–æ—á–Ω—ã–π —É—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–ø–∏—Å–∞–Ω–∏–µ–º

    üß† Reasoning Tokens - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–¥–µ–ª–µ–π —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è–º–∏

    ‚ö° Streaming - –ø–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –æ—Ç–≤–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ Server-Sent Events

    üõ†Ô∏è Tool Calling - –≤—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä—è–º–æ –∏–∑ –º–æ–¥–µ–ª–∏

    üé® –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ

    üìä Usage Accounting - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç API-–∫–ª—é—á–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization:

Authorization: Bearer YOUR_API_KEY

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
–ö–æ–Ω—Ç–µ–Ω—Ç –∏ —Å–æ–æ–±—â–µ–Ω–∏—è

–ü–∞—Ä–∞–º–µ—Ç—Ä


–¢–∏–ø


–û–ø–∏—Å–∞–Ω–∏–µ

messages


array


–ú–∞—Å—Å–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–∏–∞–ª–æ–≥–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

prompt


string


–ü—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ messages)
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

–ü–∞—Ä–∞–º–µ—Ç—Ä


–¢–∏–ø


–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é


–û–ø–∏—Å–∞–Ω–∏–µ

max_tokens


integer


–ù–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ


–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ

temperature


float (0-2)


1.0


–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. 0 = –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, 2 = –æ—á–µ–Ω—å –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π

top_p


float (0-1)


1.0


Nucleus sampling. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ temperature

top_k


integer




Top-K sampling. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—É—á—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞

frequency_penalty


float (-2 –¥–æ 2)


0


–®—Ç—Ä–∞—Ñ –∑–∞ —á–∞—Å—Ç–æ—Ç—É –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è —Å–ª–æ–≤

presence_penalty


float (-2 –¥–æ 2)


0


–®—Ç—Ä–∞—Ñ –∑–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Ç–æ–∫–µ–Ω–æ–≤

repetition_penalty


float (0.1-2)


1.0


–®—Ç—Ä–∞—Ñ –∑–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è (—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–æ–¥–µ–ª–µ–π)

stop


string | array




–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

seed


integer




–°–∏–¥ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

–ü–∞—Ä–∞–º–µ—Ç—Ä


–¢–∏–ø


–û–ø–∏—Å–∞–Ω–∏–µ

stream


boolean


–í–∫–ª—é—á–∏—Ç—å –ø–æ—Ç–æ–∫–æ–≤—ã–π —Ä–µ–∂–∏–º (SSE)

reasoning


object


–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è reasoning tokens

tools


array


–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π

tool_choice


string | object


–í—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞: "none", "auto" –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
–ë–∞–∑–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç

{
  "role": "user|assistant|system|tool",
  "content": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è"
}

–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (—Ç–µ–∫—Å—Ç + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)

{
  "role": "user",
  "content": [
    {
      "type": "text",
      "text": "–ß—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ?"
    },
    {
      "type": "image_url",
      "image_url": {
        "url": "https://example.com/image.jpg",
        "detail": "high"
      }
    }
  ]
}

–°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

{
  "role": "system",
  "content": [
    {
      "type": "text",
      "text": "–î–ª–∏–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è...",
      "cache_control": {
        "type": "ephemeral"
      }
    }
  ]
}

–§–æ—Ä–º–∞—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
200: –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
–û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º

{
  "id": "chatcmpl-123",
  "object": "chat.completion",
  "created": 1677652288,
  "model": "openai/gpt-4o",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞? –†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å!",
        "reasoning": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–∑–¥–æ—Ä–æ–≤–∞–ª—Å—è –¥—Ä—É–∂–µ–ª—é–±–Ω–æ, –æ—Ç–≤–µ—á—É –≤ —Ç–æ–º –∂–µ —Ç–æ–Ω–µ..."
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 25,
    "completion_tokens": 150,
    "total_tokens": 175,
    "prompt_tokens_details": {
      "cached_tokens": 10,
      "text_tokens": 20,
      "image_tokens": 0
    },
    "completion_tokens_details": {
      "reasoning_tokens": 30
    },
    "cost": 15.75
  }
}

Streaming —Ä–µ–∂–∏–º (Server-Sent Events)

data: {"id":"chatcmpl-123","object":"chat.completion.chunk","created":1677652288,"model":"openai/gpt-4o","choices":[{"index":0,"delta":{"role":"assistant"},"finish_reason":null}]}

data: {"id":"chatcmpl-123","object":"chat.completion.chunk","created":1677652288,"model":"openai/gpt-4o","choices":[{"index":0,"delta":{"content":"–ü—Ä–∏–≤–µ—Ç"},"finish_reason":null}]}

data: {"id":"chatcmpl-123","object":"chat.completion.chunk","created":1677652288,"model":"openai/gpt-4o","choices":[{"index":0,"delta":{"content":"! –ö–∞–∫"},"finish_reason":null}]}

data: {"id":"chatcmpl-123","object":"chat.completion.chunk","created":1677652288,"model":"openai/gpt-4o","choices":[{"index":0,"delta":{"content":" –¥–µ–ª–∞?"},"finish_reason":null}]}

data: {"id":"chatcmpl-123","object":"chat.completion.chunk","created":1677652288,"model":"openai/gpt-4o","choices":[{"index":0,"delta":{},"finish_reason":"stop"}],"usage":{"prompt_tokens":25,"completion_tokens":150,"total_tokens":175,"cost":15.75}}

data: [DONE]

–ö–æ–¥—ã –æ—à–∏–±–æ–∫

–ö–æ–¥


–û–ø–∏—Å–∞–Ω–∏–µ


–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

400


Bad Request


–ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

401


Unauthorized


–ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π API-–∫–ª—é—á

402


Payment Required


–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ

429


Too Many Requests


–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤

500


Internal Server Error


–û—à–∏–±–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞
–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

cURL

JavaScript

Python

TypeScript

Go

Ruby
–ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å

curl -X POST "https://api.polza.ai/api/v1/chat/completions" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "openai/gpt-4o",
    "messages": [
      {"role": "user", "content": "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?"}
    ]
  }'

Streaming –∑–∞–ø—Ä–æ—Å

curl -X POST "https://api.polza.ai/api/v1/chat/completions" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -H "Accept: text/event-stream" \
  -d '{
    "model": "anthropic/claude-3-5-sonnet",
    "messages": [
      {"role": "user", "content": "–†–∞—Å—Å–∫–∞–∂–∏ –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ –∫–æ—Ç–∞"}
    ],
    "stream": true
  }'

–° reasoning

curl -X POST "https://api.polza.ai/api/v1/chat/completions" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "openai/o1-preview",
    "messages": [
      {"role": "user", "content": "–†–µ—à–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: 2x + 5 = 13"}
    ],
    "reasoning": {
      "effort": "high"
    }
  }'

Fetch API

const response = await fetch('https://api.polza.ai/api/v1/chat/completions', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    model: 'openai/gpt-4o',
    messages: [
      { role: 'user', content: '–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?' }
    ]
  })
});

const data = await response.json();
console.log(data.choices[0].message.content);
console.log(`–°—Ç–æ–∏–º–æ—Å—Ç—å: ${data.usage.cost} —Ä—É–±.`);

Streaming —Å EventSource

async function streamChat() {
  const response = await fetch('https://api.polza.ai/api/v1/chat/completions', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer YOUR_API_KEY',
      'Content-Type': 'application/json',
      'Accept': 'text/event-stream'
    },
    body: JSON.stringify({
      model: 'anthropic/claude-3-5-sonnet',
      messages: [
        { role: 'user', content: '–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫—É—é –∏—Å—Ç–æ—Ä–∏—é' }
      ],
      stream: true
    })
  });

  const reader = response.body.getReader();
  const decoder = new TextDecoder();
  let content = '';

  while (true) {
    const { done, value } = await reader.read();
    if (done) break;

    const chunk = decoder.decode(value, { stream: true });
    const lines = chunk.split('\n');

    for (const line of lines) {
      if (line.startsWith('data: ')) {
        const data = line.slice(6);
        if (data === '[DONE]') return content;

        try {
          const parsed = JSON.parse(data);
          const delta = parsed.choices?.[0]?.delta?.content;

          if (delta) {
            content += delta;
            console.log(delta);
          }


          if (parsed.usage) {
            console.log(`\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:`);
            console.log(`–¢–æ–∫–µ–Ω—ã: ${parsed.usage.total_tokens}`);
            console.log(`–°—Ç–æ–∏–º–æ—Å—Ç—å: ${parsed.usage.cost} —Ä—É–±.`);
          }
        } catch (err) {
          console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞:', err);
        }
      }
    }
  }
}

streamChat();

–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å

const imageResponse = await fetch('https://api.polza.ai/api/v1/chat/completions', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    model: 'openai/gpt-4o',
    messages: [
      {
        role: 'user',
        content: [
          {
            type: 'text',
            text: '–û–ø–∏—à–∏ —á—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ'
          },
          {
            type: 'image_url',
            image_url: {
              url: 'https://example.com/cat.jpg',
              detail: 'high'
            }
          }
        ]
      }
    ]
  })
});

–û–±—ã—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å

import requests

response = requests.post(
    'https://api.polza.ai/api/v1/chat/completions',
    headers={
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    json={
        'model': 'anthropic/claude-3-5-sonnet',
        'messages': [
            {'role': 'user', 'content': '–û–±—ä—è—Å–Ω–∏ –∫–≤–∞–Ω—Ç–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏'}
        ]
    }
)

data = response.json()
print(data['choices'][0]['message']['content'])
print(f"–°—Ç–æ–∏–º–æ—Å—Ç—å: {data['usage']['cost']} —Ä—É–±.")

Streaming

import requests
import json

def stream_chat(messages):
    response = requests.post(
        'https://api.polza.ai/api/v1/chat/completions',
        headers={
            'Authorization': 'Bearer YOUR_API_KEY',
            'Content-Type': 'application/json',
            'Accept': 'text/event-stream'
        },
        json={
            'model': 'openai/gpt-4o',
            'messages': messages,
            'stream': True
        },
        stream=True
    )

    content = ''

    for line in response.iter_lines(decode_unicode=True):
        if line.startswith('data: '):
            data = line[6:]
            if data == '[DONE]':
                break

            try:
                parsed = json.loads(data)
                delta = parsed.get('choices', [{}])[0].get('delta', {}).get('content')

                if delta:
                    content += delta
                    print(delta, end='', flush=True)


                if 'usage' in parsed:
                    print(f"\n\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
                    print(f"–¢–æ–∫–µ–Ω—ã: {parsed['usage']['total_tokens']}")
                    print(f"–°—Ç–æ–∏–º–æ—Å—Ç—å: {parsed['usage']['cost']} —Ä—É–±.")

            except json.JSONDecodeError:
                continue

    return content


messages = [
    {'role': 'user', 'content': '–ù–∞–ø–∏—à–∏ —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ –∑–∏–º—É'}
]
result = stream_chat(messages)

–° reasoning tokens

response = requests.post(
    'https://api.polza.ai/api/v1/chat/completions',
    headers={
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    json={
        'model': 'deepseek/deepseek-r1',
        'messages': [
            {'role': 'user', 'content': '–†–µ—à–∏ —Å–ª–æ–∂–Ω—É—é –∑–∞–¥–∞—á—É –ø–æ —Ñ–∏–∑–∏–∫–µ: –Ω–∞–π–¥–∏ —Å–∫–æ—Ä–æ—Å—Ç—å —Å–≤–µ—Ç–∞'}
        ],
        'reasoning': {
            'effort': 'high',
            'max_tokens': 2000
        }
    }
)

data = response.json()
message = data['choices'][0]['message']

print("–†–∞—Å—Å—É–∂–¥–µ–Ω–∏—è –º–æ–¥–µ–ª–∏:")
print(message.get('reasoning', '–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ'))
print("\n–§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:")
print(message['content'])


usage = data['usage']
print(f"\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
print(f"Reasoning —Ç–æ–∫–µ–Ω—ã: {usage['completion_tokens_details']['reasoning_tokens']}")
print(f"–û–±—ã—á–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã: {usage['completion_tokens'] - usage['completion_tokens_details']['reasoning_tokens']}")
print(f"–°—Ç–æ–∏–º–æ—Å—Ç—å: {usage['cost']} —Ä—É–±.")

–°—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã

interface ChatMessage {
  role: 'user' | 'assistant' | 'system' | 'tool';
  content: string | Array<{
    type: 'text' | 'image_url';
    text?: string;
    image_url?: {
      url: string;
      detail?: 'low' | 'high' | 'auto';
    };
  }>;
}

interface ChatCompletionRequest {
  model: string;
  messages: ChatMessage[];
  max_tokens?: number;
  temperature?: number;
  stream?: boolean;
  reasoning?: {
    effort?: 'high' | 'medium' | 'low';
    max_tokens?: number;
    exclude?: boolean;
  };
}

interface Usage {
  prompt_tokens: number;
  completion_tokens: number;
  total_tokens: number;
  cost?: number;
  prompt_tokens_details?: {
    cached_tokens?: number;
    text_tokens?: number;
    image_tokens?: number;
  };
  completion_tokens_details?: {
    reasoning_tokens?: number;
  };
}

interface ChatCompletionResponse {
  id: string;
  object: string;
  created: number;
  model: string;
  choices: Array<{
    index: number;
    message: {
      role: string;
      content: string | null;
      reasoning?: string;
    };
    finish_reason: string | null;
  }>;
  usage?: Usage;
}

async function createChatCompletion(
  request: ChatCompletionRequest
): Promise<ChatCompletionResponse> {
  const response = await fetch('https://api.polza.ai/api/v1/chat/completions', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer YOUR_API_KEY',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(request)
  });

  if (!response.ok) {
    throw new Error(`HTTP error! status: ${response.status}`);
  }

  return response.json();
}


async function example() {
  try {
    const result = await createChatCompletion({
      model: 'openai/gpt-4o',
      messages: [
        { role: 'user', content: '–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?' }
      ],
      temperature: 0.7,
      max_tokens: 150
    });

    console.log('–û—Ç–≤–µ—Ç:', result.choices[0].message.content);
    console.log('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:', result.usage);
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
  }
}

–û–±—Ä–∞–±–æ—Ç–∫–∞ streaming

interface StreamChunk {
  id: string;
  object: string;
  created: number;
  model: string;
  choices: Array<{
    index: number;
    delta: {
      role?: string;
      content?: string | null;
      reasoning?: string;
    };
    finish_reason: string | null;
  }>;
  usage?: Usage;
}

async function streamChatCompletion(
  request: ChatCompletionRequest,
  onChunk: (chunk: StreamChunk) => void,
  onComplete: (usage?: Usage) => void
): Promise<void> {
  const response = await fetch('https://api.polza.ai/api/v1/chat/completions', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer YOUR_API_KEY',
      'Content-Type': 'application/json',
      'Accept': 'text/event-stream'
    },
    body: JSON.stringify({ ...request, stream: true })
  });

  if (!response.body) throw new Error('No response body');

  const reader = response.body.getReader();
  const decoder = new TextDecoder();

  try {
    while (true) {
      const { done, value } = await reader.read();
      if (done) break;

      const chunk = decoder.decode(value, { stream: true });
      const lines = chunk.split('\n');

      for (const line of lines) {
        if (line.startsWith('data: ')) {
          const data = line.slice(6);
          if (data === '[DONE]') {
            onComplete();
            return;
          }

          try {
            const parsed: StreamChunk = JSON.parse(data);
            onChunk(parsed);


            if (parsed.usage) {
              onComplete(parsed.usage);
            }
          } catch (err) {
            console.warn('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ —á–∞–Ω–∫–∞:', err);
          }
        }
      }
    }
  } finally {
    reader.releaseLock();
  }
}


async function streamExample() {
  let content = '';

  await streamChatCompletion(
    {
      model: 'anthropic/claude-3-5-sonnet',
      messages: [
        { role: 'user', content: '–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫—É—é –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ —Ä–æ–±–æ—Ç–∞' }
      ]
    },
    (chunk) => {
      const delta = chunk.choices?.[0]?.delta?.content;
      if (delta) {
        content += delta;
        process.stdout.write(delta);
      }
    },
    (usage) => {
      if (usage) {
        console.log(`\n\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:`);
        console.log(`–¢–æ–∫–µ–Ω—ã: ${usage.total_tokens}`);
        console.log(`–°—Ç–æ–∏–º–æ—Å—Ç—å: ${usage.cost} —Ä—É–±.`);
      }
    }
  );
}

package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "net/http"
    "bufio"
    "strings"
    "io"
)

type Message struct {
    Role    string `json:"role"`
    Content string `json:"content"`
}

type ChatRequest struct {
    Model       string    `json:"model"`
    Messages    []Message `json:"messages"`
    MaxTokens   int       `json:"max_tokens,omitempty"`
    Temperature float64   `json:"temperature,omitempty"`
    Stream      bool      `json:"stream,omitempty"`
}

type Usage struct {
    PromptTokens     int     `json:"prompt_tokens"`
    CompletionTokens int     `json:"completion_tokens"`
    TotalTokens      int     `json:"total_tokens"`
    Cost             float64 `json:"cost,omitempty"`
}

type Choice struct {
    Index        int    `json:"index"`
    Message      Message `json:"message,omitempty"`
    FinishReason string `json:"finish_reason"`
}

type ChatResponse struct {
    ID      string   `json:"id"`
    Object  string   `json:"object"`
    Created int64    `json:"created"`
    Model   string   `json:"model"`
    Choices []Choice `json:"choices"`
    Usage   Usage    `json:"usage"`
}

func createChatCompletion(apiKey string, request ChatRequest) (*ChatResponse, error) {
    jsonData, err := json.Marshal(request)
    if err != nil {
        return nil, err
    }

    req, err := http.NewRequest("POST", "https://api.polza.ai/api/v1/chat/completions", bytes.NewBuffer(jsonData))
    if err != nil {
        return nil, err
    }

    req.Header.Set("Authorization", "Bearer "+apiKey)
    req.Header.Set("Content-Type", "application/json")

    client := &http.Client{}
    resp, err := client.Do(req)
    if err != nil {
        return nil, err
    }
    defer resp.Body.Close()

    body, err := io.ReadAll(resp.Body)
    if err != nil {
        return nil, err
    }

    var chatResp ChatResponse
    err = json.Unmarshal(body, &chatResp)
    if err != nil {
        return nil, err
    }

    return &chatResp, nil
}

func streamChatCompletion(apiKey string, request ChatRequest) error {
    request.Stream = true
    jsonData, err := json.Marshal(request)
    if err != nil {
        return err
    }

    req, err := http.NewRequest("POST", "https://api.polza.ai/api/v1/chat/completions", bytes.NewBuffer(jsonData))
    if err != nil {
        return err
    }

    req.Header.Set("Authorization", "Bearer "+apiKey)
    req.Header.Set("Content-Type", "application/json")
    req.Header.Set("Accept", "text/event-stream")

    client := &http.Client{}
    resp, err := client.Do(req)
    if err != nil {
        return err
    }
    defer resp.Body.Close()

    scanner := bufio.NewScanner(resp.Body)
    for scanner.Scan() {
        line := scanner.Text()
        if strings.HasPrefix(line, "data: ") {
            data := line[6:]
            if data == "[DONE]" {
                break
            }

            var chunk map[string]interface{}
            if err := json.Unmarshal([]byte(data), &chunk); err == nil {
                if choices, ok := chunk["choices"].([]interface{}); ok && len(choices) > 0 {
                    choice := choices[0].(map[string]interface{})
                    if delta, ok := choice["delta"].(map[string]interface{}); ok {
                        if content, ok := delta["content"].(string); ok {
                            fmt.Print(content)
                        }
                    }
                }


                if usage, ok := chunk["usage"].(map[string]interface{}); ok {
                    fmt.Printf("\n\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:\n")
                    fmt.Printf("–¢–æ–∫–µ–Ω—ã: %.0f\n", usage["total_tokens"])
                    if cost, ok := usage["cost"]; ok {
                        fmt.Printf("–°—Ç–æ–∏–º–æ—Å—Ç—å: %.2f —Ä—É–±.\n", cost)
                    }
                }
            }
        }
    }

    return scanner.Err()
}

func main() {
    apiKey := "YOUR_API_KEY"


    request := ChatRequest{
        Model: "openai/gpt-4o",
        Messages: []Message{
            {Role: "user", Content: "–ü—Ä–∏–≤–µ—Ç! –†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ Go"},
        },
        Temperature: 0.7,
        MaxTokens: 200,
    }

    resp, err := createChatCompletion(apiKey, request)
    if err != nil {
        panic(err)
    }

    fmt.Printf("–û—Ç–≤–µ—Ç: %s\n", resp.Choices[0].Message.Content)
    fmt.Printf("–°—Ç–æ–∏–º–æ—Å—Ç—å: %.2f —Ä—É–±.\n", resp.Usage.Cost)


    fmt.Printf("\n\nStreaming –ø—Ä–∏–º–µ—Ä:\n")
    streamRequest := ChatRequest{
        Model: "anthropic/claude-3-5-sonnet",
        Messages: []Message{
            {Role: "user", Content: "–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫—É—é –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞"},
        },
    }

    err = streamChatCompletion(apiKey, streamRequest)
    if err != nil {
        panic(err)
    }
}

require 'net/http'
require 'json'
require 'uri'

class PolzaAI
  BASE_URL = 'https://api.polza.ai/api/v1'

  def initialize(api_key)
    @api_key = api_key
  end

  def chat_completion(model:, messages:, **options)
    uri = URI("#{BASE_URL}/chat/completions")

    payload = {
      model: model,
      messages: messages
    }.merge(options)

    request = Net::HTTP::Post.new(uri)
    request['Authorization'] = "Bearer #{@api_key}"
    request['Content-Type'] = 'application/json'
    request.body = payload.to_json

    response = Net::HTTP.start(uri.hostname, uri.port, use_ssl: true) do |http|
      http.request(request)
    end

    JSON.parse(response.body)
  end

  def stream_chat_completion(model:, messages:, **options)
    uri = URI("#{BASE_URL}/chat/completions")

    payload = {
      model: model,
      messages: messages,
      stream: true
    }.merge(options)

    request = Net::HTTP::Post.new(uri)
    request['Authorization'] = "Bearer #{@api_key}"
    request['Content-Type'] = 'application/json'
    request['Accept'] = 'text/event-stream'
    request.body = payload.to_json

    Net::HTTP.start(uri.hostname, uri.port, use_ssl: true) do |http|
      http.request(request) do |response|
        response.read_body do |chunk|
          chunk.each_line do |line|
            if line.start_with?('data: ')
              data = line[6..-1].strip
              next if data == '[DONE]'

              begin
                parsed = JSON.parse(data)


                if parsed['choices'] && parsed['choices'][0] && parsed['choices'][0]['delta']
                  delta = parsed['choices'][0]['delta']
                  if delta['content']
                    print delta['content']
                    $stdout.flush
                  end
                end


                if parsed['usage']
                  puts "\n\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:"
                  puts "–¢–æ–∫–µ–Ω—ã: #{parsed['usage']['total_tokens']}"
                  puts "–°—Ç–æ–∏–º–æ—Å—Ç—å: #{parsed['usage']['cost']} —Ä—É–±." if parsed['usage']['cost']
                end

              rescue JSON::ParserError

              end
            end
          end
        end
      end
    end
  end
end


client = PolzaAI.new('YOUR_API_KEY')


puts "–û–±—ã—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å:"
response = client.chat_completion(
  model: 'openai/gpt-4o',
  messages: [
    { role: 'user', content: '–ü—Ä–∏–≤–µ—Ç! –†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ Ruby' }
  ],
  temperature: 0.7,
  max_tokens: 200
)

puts response['choices'][0]['message']['content']
puts "–°—Ç–æ–∏–º–æ—Å—Ç—å: #{response['usage']['cost']} —Ä—É–±."


puts "\n\nStreaming –∑–∞–ø—Ä–æ—Å:"
client.stream_chat_completion(
  model: 'anthropic/claude-3-5-sonnet',
  messages: [
    { role: 'user', content: '–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫—É—é –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ –∫–æ—Ç–∞-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞' }
  ]
)


puts "\n\n–° reasoning —Ç–æ–∫–µ–Ω–∞–º–∏:"
reasoning_response = client.chat_completion(
  model: 'openai/o1-preview',
  messages: [
    { role: 'user', content: '–†–µ—à–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É: –Ω–∞–π–¥–∏ –∫–æ—Ä–Ω–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è x¬≤ - 5x + 6 = 0' }
  ],
  reasoning: {
    effort: 'high'
  }
)

message = reasoning_response['choices'][0]['message']
puts "–†–∞—Å—Å—É–∂–¥–µ–Ω–∏—è: #{message['reasoning']}" if message['reasoning']
puts "–û—Ç–≤–µ—Ç: #{message['content']}"

usage = reasoning_response['usage']
if usage['completion_tokens_details'] && usage['completion_tokens_details']['reasoning_tokens']
  puts "Reasoning —Ç–æ–∫–µ–Ω—ã: #{usage['completion_tokens_details']['reasoning_tokens']}"
end
puts "–°—Ç–æ–∏–º–æ—Å—Ç—å: #{usage['cost']} —Ä—É–±."

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI SDK

–ù–∞—à API –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º —Å OpenAI SDK. –ü—Ä–æ—Å—Ç–æ –∑–∞–º–µ–Ω–∏—Ç–µ –±–∞–∑–æ–≤—ã–π URL:

Python (OpenAI)

TypeScript (OpenAI)

Node.js (OpenAI)

from openai import OpenAI

client = OpenAI(
    base_url="https://api.polza.ai/api/v1",
    api_key="YOUR_POLZA_API_KEY"
)


response = client.chat.completions.create(
    model="anthropic/claude-3-5-sonnet",
    messages=[
        {"role": "user", "content": "–û–±—ä—è—Å–Ω–∏ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ"}
    ]
)

print(response.choices[0].message.content)
print(f"–°—Ç–æ–∏–º–æ—Å—Ç—å: {response.usage.cost} —Ä—É–±.")


stream = client.chat.completions.create(
    model="openai/gpt-4o",
    messages=[
        {"role": "user", "content": "–ù–∞–ø–∏—à–∏ –∫–æ–¥ –Ω–∞ Python"}
    ],
    stream=True
)

for chunk in stream:
    if chunk.choices[0].delta.content is not None:
        print(chunk.choices[0].delta.content, end="")


response = client.chat.completions.create(
    model="openai/gpt-4o",
    messages=[
        {
            "role": "user",
            "content": [
                {"type": "text", "text": "–ß—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ?"},
                {
                    "type": "image_url",
                    "image_url": {
                        "url": "https://example.com/image.jpg"
                    }
                }
            ]
        }
    ]
)

import OpenAI from 'openai';

const openai = new OpenAI({
  baseURL: 'https://api.polza.ai/api/v1',
  apiKey: 'YOUR_POLZA_API_KEY'
});


async function basicChat() {
  const completion = await openai.chat.completions.create({
    model: 'openai/gpt-4o',
    messages: [
      { role: 'user', content: '–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?' }
    ]
  });

  console.log(completion.choices[0].message.content);
  console.log(`–°—Ç–æ–∏–º–æ—Å—Ç—å: ${completion.usage?.cost} —Ä—É–±.`);
}


async function streamChat() {
  const stream = await openai.chat.completions.create({
    model: 'anthropic/claude-3-5-sonnet',
    messages: [
      { role: 'user', content: '–†–∞—Å—Å–∫–∞–∂–∏ –∏—Å—Ç–æ—Ä–∏—é' }
    ],
    stream: true
  });

  for await (const chunk of stream) {
    const content = chunk.choices[0]?.delta?.content;
    if (content) {
      process.stdout.write(content);
    }


    if (chunk.usage) {
      console.log(`\n–°—Ç–æ–∏–º–æ—Å—Ç—å: ${chunk.usage.cost} —Ä—É–±.`);
    }
  }
}


async function functionCall() {
  const completion = await openai.chat.completions.create({
    model: 'openai/gpt-4o',
    messages: [
      { role: 'user', content: '–ö–∞–∫–∞—è —Å–µ–π—á–∞—Å –ø–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–µ?' }
    ],
    tools: [
      {
        type: 'function',
        function: {
          name: 'get_weather',
          description: '–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø–æ–≥–æ–¥—É –≤ –≥–æ—Ä–æ–¥–µ',
          parameters: {
            type: 'object',
            properties: {
              city: {
                type: 'string',
                description: '–ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞'
              }
            },
            required: ['city']
          }
        }
      }
    ],
    tool_choice: 'auto'
  });

  const message = completion.choices[0].message;

  if (message.tool_calls) {
    for (const toolCall of message.tool_calls) {
      if (toolCall.function.name === 'get_weather') {
        const args = JSON.parse(toolCall.function.arguments);
        console.log(`–í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ get_weather –¥–ª—è –≥–æ—Ä–æ–¥–∞: ${args.city}`);





      }
    }
  }
}

basicChat();

const OpenAI = require('openai');

const openai = new OpenAI({
  baseURL: 'https://api.polza.ai/api/v1',
  apiKey: process.env.POLZA_API_KEY
});


async function simpleChat() {
  try {
    const completion = await openai.chat.completions.create({
      model: 'openai/gpt-4o-mini',
      messages: [
        { role: 'system', content: '–¢—ã –ø–æ–ª–µ–∑–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫.' },
        { role: 'user', content: '–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ JavaScript' }
      ],
      max_tokens: 500
    });

    console.log('–û—Ç–≤–µ—Ç:', completion.choices[0].message.content);
    console.log('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:', completion.usage);
    console.log(`–°—Ç–æ–∏–º–æ—Å—Ç—å: ${completion.usage.cost} —Ä—É–±.`);
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
  }
}


async function conversationLoop() {
  const messages = [
    { role: 'system', content: '–¢—ã –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞.' }
  ];

  const questions = [
    '–ß—Ç–æ —Ç–∞–∫–æ–µ promises –≤ JavaScript?',
    '–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç async/await?',
    '–í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É let –∏ const?'
  ];

  for (const question of questions) {
    messages.push({ role: 'user', content: question });

    const completion = await openai.chat.completions.create({
      model: 'anthropic/claude-3-5-sonnet',
      messages: messages,
      temperature: 0.7
    });

    const answer = completion.choices[0].message.content;
    messages.push({ role: 'assistant', content: answer });

    console.log(`\nü§î –í–æ–ø—Ä–æ—Å: ${question}`);
    console.log(`ü§ñ –û—Ç–≤–µ—Ç: ${answer}`);
    console.log(`üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: ${completion.usage.cost} —Ä—É–±.`);
  }

  console.log('\nüìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–∏–∞–ª–æ–≥–∞:',
              messages.length, '—Å–æ–æ–±—â–µ–Ω–∏–π');
}


simpleChat();

Tool Calling (–í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π)

–ù–∞—à API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä—è–º–æ –∏–∑ –º–æ–¥–µ–ª–∏:
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

{
  "model": "openai/gpt-4o",
  "messages": [
    {"role": "user", "content": "–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–µ?"}
  ],
  "tools": [
    {
      "type": "function",
      "function": {
        "name": "get_weather",
        "description": "–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø–æ–≥–æ–¥—É –≤ –≥–æ—Ä–æ–¥–µ",
        "parameters": {
          "type": "object",
          "properties": {
            "city": {
              "type": "string",
              "description": "–ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞"
            },
            "units": {
              "type": "string",
              "enum": ["celsius", "fahrenheit"],
              "description": "–ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã"
            }
          },
          "required": ["city"]
        }
      }
    }
  ],
  "tool_choice": "auto"
}

–û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ —Å –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏

{
  "choices": [
    {
      "message": {
        "role": "assistant",
        "content": null,
        "tool_calls": [
          {
            "id": "call_123",
            "type": "function",
            "function": {
              "name": "get_weather",
              "arguments": "{\"city\": \"–ú–æ—Å–∫–≤–∞\", \"units\": \"celsius\"}"
            }
          }
        ]
      }
    }
  ]
}

–û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏

{
  "model": "openai/gpt-4o",
  "messages": [
    {"role": "user", "content": "–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–µ?"},
    {
      "role": "assistant",
      "tool_calls": [
        {
          "id": "call_123",
          "type": "function",
          "function": {
            "name": "get_weather",
            "arguments": "{\"city\": \"–ú–æ—Å–∫–≤–∞\"}"
          }
        }
      ]
    },
    {
      "role": "tool",
      "tool_call_id": "call_123",
      "name": "get_weather",
      "content": "{\"temperature\": -5, \"condition\": \"snow\", \"humidity\": 80}"
    }
  ]
}

Reasoning Tokens

–ú–æ–¥–µ–ª–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π reasoning –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è:
–ó–∞–ø—Ä–æ—Å —Å reasoning

{
  "model": "openai/o1-preview",
  "messages": [
    {"role": "user", "content": "–†–µ—à–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: 2x + 5 = 13"}
  ],
  "reasoning": {
    "effort": "high",
    "max_tokens": 1000
  }
}

–û—Ç–≤–µ—Ç —Å —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è–º–∏

{
  "choices": [
    {
      "message": {
        "role": "assistant",
        "content": "x = 4",
        "reasoning": "–ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏–µ 2x + 5 = 13.\n\n–ù–∞—á–Ω—É —Å –≤—ã—á–∏—Ç–∞–Ω–∏—è 5 –∏–∑ –æ–±–µ–∏—Ö —á–∞—Å—Ç–µ–π:\n2x + 5 - 5 = 13 - 5\n2x = 8\n\n–¢–µ–ø–µ—Ä—å —Ä–∞–∑–¥–µ–ª—é –æ–±–µ —á–∞—Å—Ç–∏ –Ω–∞ 2:\n2x / 2 = 8 / 2\nx = 4\n\n–ü—Ä–æ–≤–µ—Ä–∏–º: 2(4) + 5 = 8 + 5 = 13 ‚úì"
      }
    }
  ],
  "usage": {
    "completion_tokens_details": {
      "reasoning_tokens": 89
    }
  }
}

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: Reasoning Tokens –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
1. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π:

{
  "messages": [
    {
      "role": "system",
      "content": [
        {
          "type": "text",
          "text": "–û—á–µ–Ω—å –¥–ª–∏–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è...",
          "cache_control": {
            "type": "ephemeral"
          }
        }
      ]
    }
  ]
}

2. Streaming –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

–î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞:


const response = await fetch(url, { stream: false });


const stream = await fetch(url, {
  stream: true,
  headers: { 'Accept': 'text/event-stream' }
});

3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ max_tokens

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ —Ä–∞–∑—É–º–Ω—ã–µ –ª–∏–º–∏—Ç—ã:

{
  "max_tokens": 500,
  "temperature": 0.7
}

–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

–û—à–∏–±–∫–∞


–†–µ—à–µ–Ω–∏–µ

401 Unauthorized


–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API-–∫–ª—é—á –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization

402 Payment Required


–ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã

400 Model not found


–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—á–Ω—ã–π ID –º–æ–¥–µ–ª–∏ –∏–∑ /models

429 Rate Limit


–°–Ω–∏–∑—å—Ç–µ —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É

Streaming –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è


–ü—Ä–æ–≤–µ—Ä—å—Ç–µ keep-alive —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
–ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

async function robustChatRequest(request) {
  const maxRetries = 3;
  let lastError;

  for (let i = 0; i < maxRetries; i++) {
    try {
      const response = await fetch('https://api.polza.ai/api/v1/chat/completions', {
        method: 'POST',
        headers: {
          'Authorization': 'Bearer YOUR_API_KEY',
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(request)
      });

      if (!response.ok) {
        const error = await response.json();

        switch (response.status) {
          case 402:
            throw new Error(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤: ${error.error?.message}`);
          case 429:

            await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000));
            continue;
          case 400:
            throw new Error(`–ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å: ${error.error?.message}`);
          default:
            throw new Error(`HTTP ${response.status}: ${error.error?.message}`);
        }
      }

      return await response.json();

    } catch (error) {
      lastError = error;


      if (error.message.includes('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤') ||
          error.message.includes('–ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å')) {
        throw error;
      }

      console.warn(`–ü–æ–ø—ã—Ç–∫–∞ ${i + 1} –Ω–µ—É–¥–∞—á–Ω–∞:`, error.message);
    }
  }

  throw lastError;
}

–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã
Q: –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É messages –∏ prompt?

A: messages - —ç—Ç–æ –¥–∏–∞–ª–æ–≥–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —á–∞—Ç–æ–≤, prompt - –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å messages –¥–ª—è –ª—É—á—à–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ –¥–∏–∞–ª–æ–≥–æ–º.
Q: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—ã–±–æ—Ä –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –¥–ª—è –º–æ–¥–µ–ª–∏?

A: –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–µ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, —Ü–µ–Ω—ã –∏ –∫–∞—á–µ—Å—Ç–≤–∞. –í—ã –ø—Ä–æ—Å—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç–µ ID –º–æ–¥–µ–ª–∏ –∏–∑ /models.
Q: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª–∏ vision –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π?

A: –ù–µ—Ç, —Ç–æ–ª—å–∫–æ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ architecture.input_modalities –≤ —Å–ø–∏—Å–∫–µ –º–æ–¥–µ–ª–µ–π.
Q: –ö–∞–∫ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤?

A:

    –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –ø—Ä–æ–º–ø—Ç–æ–≤

    –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ max_tokens

    –í—ã–±–∏—Ä–∞–π—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é –º–æ–¥–µ–ª—å (–Ω–µ –≤—Å–µ–≥–¥–∞ –Ω—É–∂–µ–Ω GPT-4)

    –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ usage.cost –≤ –æ—Ç–≤–µ—Ç–∞—Ö

Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ streaming —Å reasoning —Ç–æ–∫–µ–Ω–∞–º–∏?

A: –î–∞, reasoning —Ç–æ–∫–µ–Ω—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ streaming —Ä–µ–∂–∏–º–µ –¥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å LangChain?

A: –î–∞, –ø—Ä–æ—Å—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ OpenAI chat model —Å –Ω–∞—à–∏–º base_url:

from langchain.chat_models import ChatOpenAI

llm = ChatOpenAI(
    base_url="https://api.polza.ai/api/v1",
    api_key="YOUR_POLZA_API_KEY",
    model="anthropic/claude-4-sonnet"
)

Q: –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º?

A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π API endpoint –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å–∞ –∏–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ 402.
Q: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ tool calls?

A: –î–∞, –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –æ–¥–Ω–æ–º –æ—Ç–≤–µ—Ç–µ.
–õ–∏–º–∏—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
–ü–æ –∑–∞–ø—Ä–æ—Å–∞–º

    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞: 32MB

    Timeout: 300 —Å–µ–∫—É–Ω–¥ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

    Rate limiting: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±–∞–ª–∞–Ω—Å–∞ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ —Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º

–ü–æ —Ç–æ–∫–µ–Ω–∞–º

    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏ (—Å–º. /models)

    max_tokens: –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—à–∞—Ç—å –ª–∏–º–∏—Ç –º–æ–¥–µ–ª–∏

    Reasoning —Ç–æ–∫–µ–Ω—ã: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–æ–¥–µ–ª–∏

–ü–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É

    –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: –¥–æ 20MB –∫–∞–∂–¥–æ–µ, —Ñ–æ—Ä–º–∞—Ç—ã: PNG, JPEG, WebP, GIF

    –ú–æ–¥–µ—Ä–∞—Ü–∏—è: –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç –∫–æ–Ω—Ç–µ–Ω—Ç

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: Usage –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
